alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit Webcore SVGAnimateElementBase use after free attempt"; flow:to_server,established; file_data; content:".parentNode"; nocase; content:"catch"; within:30; nocase; content:"try|7B|"; nocase; content:".after"; within:30; nocase; content:"catch"; within:30; nocase; content:"try|7B|"; distance:0; nocase; content:".autofocus"; within:60; fast_pattern; nocase; content:"true"; within:10; nocase; content:"catch"; within:30; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4314; classtype:attempted-user; sid:56043; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit attribute child removal code execution attempt"; flow:to_server,established; file_data; content:".InnerHTML="; nocase; content:".childNodes"; nocase; content:".removeChild"; nocase; content:"|5B 30 5D|.nodeValue"; content:"|7D 2C 20 31 29 3B|"; within:150; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,40642; reference:cve,2010-1119; classtype:attempted-user; sid:56042; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit JSPropertyNameEnumeration type confusion attempt"; flow:to_server,established; file_data; content:"new ArrayBuffer|28|1024 * 1024 * 10|29 3B|"; content:".__proto__ = |7B 7D 3B|"; within:200; content:".__proto__ = |7B 7D 3B|"; within:150; content:"new Uint32Array|28|100|29 3B|"; within:150; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4416; reference:url,packetstormsecurity.com/files/150528/WebKit-JSC-JIT-JSPropertyNameEnumerator-Type-Confusion.html; classtype:attempted-user; sid:56009; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit AudioArray allocate out of bounds access attempt"; flow:to_server,established; file_data; content:"new webkitOfflineAudioContext("; content:"new Uint8Array("; distance:0; content:".set("; distance:0; content:"new Uint8Array("; distance:0; content:".set("; distance:0; content:".decodeAudioData("; distance:0; content:".createBuffer("; distance:0; content:".getChannelData("; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2020-3894; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=1999; classtype:attempted-user; sid:55013; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JIT compiler common subexpression elimination out of bounds access attempt"; flow:to_server,established; file_data; content:"0xffffffff"; nocase; content:"&"; distance:0; content:"0xffffffff"; within:18; nocase; content:"new Array("; distance:0; content:".fill("; distance:0; content:".length"; distance:0; content:"return"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2020-9802; classtype:attempted-user; sid:54666; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit type confusion attempt"; flow:to_server,established; file_data; content:"function"; content:"{set:Array}|3B|"; content:"Object.defineProperty"; content:".length"; content:"new Uint8ClampedArray("; fast_pattern:only; content:".length|3B|"; content:"(true)"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8765; classtype:attempted-dos; sid:53478; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit JavaScript engine type confusion attempt"; flow:to_server,established; file_data; content:"Object.__proto__"; fast_pattern:only; content:"Object.shift("; content:"=arguments"; within:75; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-8820; reference:url,support.apple.com/en-us/HT210721; classtype:attempted-user; sid:53473; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit cached page universal cross-site scripting attempt"; flow:to_server,established; file_data; content:"document.exitPointerLock()|3B|"; fast_pattern:only; content:"open("; content:"addEventListener("; within:500; content:"open"; within:250; content:"javascript:"; within:100; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,support.apple.com/HT210721; classtype:attempted-user; sid:53124; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit cached page memory corruption attempt"; flow:to_server,established; file_data; content:"const FRAME_COUNT"; fast_pattern:only; content:"history."; content:"parentNode.remove"; distance:0; content:".pop().remove()|3B|"; distance:0; content:"contentWindow.onunload"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8822; reference:url,support.apple.com/HT210721; classtype:attempted-user; sid:53122; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit WebCore memory corruption attempt"; flow:to_server,established; file_data; content:"|3A|enabled|20 7B 20|content|3A 20|url|28|#"; content:"-webkit-transform|3A 20|scale|28|"; content:"scrollHeight"; content:"<keygen"; fast_pattern:only; content:"<input"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4200; reference:url,support.apple.com/en-us/HT208853; classtype:attempted-user; sid:53101; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt"; flow:to_server,established; file_data; content:"window.onkeydown=function(e){if("; content:"keyCode=="; within:100; content:"document.location.href="; within:1000; metadata:policy max-detect-ips drop, service smtp; reference:cve,2015-7007; reference:url,attack.mitre.org/techniques/T1155; reference:url,support.apple.com/en-us/HT205375; classtype:attempted-user; sid:52622; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_server,established; file_data; content:"<style"; content:"[title"; within:200; content:"</style>"; within:200; content:"<script"; within:200; content:"document.firstChild"; within:200; content:"innerHTML"; within:75; content:"</script"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:52597; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit updateMinimumColumnHeight use-after-free attempt"; flow:to_server,established; file_data; content:">]C9C^]x:.</dt>"; fast_pattern:only; content:"createElement"; content:"-webkit-column-width:"; content:"1px|3B|"; within:15; content:"column-span:"; content:"all|3B|"; within:15; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4323; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:52485; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit out-of-bounds read attempt"; flow:to_server,established; file_data; content:", 0x1234|29 3B|"; fast_pattern:only; content:"function"; content:"value, ..."; within:100; content:"for (let"; content:"i < 100000"; within:50; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-8689; reference:url,support.apple.com/en-us/HT210353; classtype:attempted-user; sid:52342; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit memory corruption attempt"; flow:to_server,established; file_data; content:"k = 0x1234|3B 0A 0A 20 20 20 20 20 20 20 20 20 20 20 20|function k() {|0A 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4368; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52316; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit memory corruption attempt"; flow:to_server,established; file_data; content:"function"; content:"(){let"; within:50; content:"let"; content:"={a:"; within:25; fast_pattern; content:"function"; content:"(){}"; within:50; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4368; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52314; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit handleIntrinsicCall type confusion attempt"; flow:to_server,established; file_data; content:"Array.prototype.__defineGetter__"; fast_pattern:only; content:"prototype.push"; nocase; content:"new Array"; within:100; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4382; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52244; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit WebCore handleMenuItemSelected use after free attempt"; flow:to_server,established; file_data; content:"document.implementation.createHTMLDocument|28 22|doc|22 29 3B|"; fast_pattern:only; content:"new Uint8Array|28|1024|2A|1024|29 3B|"; content:".remove|28 29|"; distance:0; content:"onblur="; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4312; classtype:attempted-user; sid:52002; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JavaScriptCore JSValue use after free attempt"; flow:to_server,established; file_data; content:"|3B| i++) {new Float64Array(0x1000000)|3B|}"; fast_pattern:only; content:"new Uint32Array()|3B|const"; content:".values()|3B|} catch"; distance:0; content:" = new Float64Array(0x10000)|3B|}"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8672; classtype:attempted-user; sid:51824; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JavaScriptCore AIR optimization memory corruption attempt"; flow:to_server,established; file_data; content:" - -0x80000000|3B|const "; fast_pattern:only; content:"|3B|}for (let i = 0|3B| i < 100|3B| i++) {"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8611; classtype:attempted-user; sid:51821; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari memory corruption attempt"; flow:to_server,established; file_data; content:"new Date()|3B|while (new Date() - "; content:"new ArrayBuffer(1024 * 1024 * 1)|3B|}}function"; content:"|3B|setTimeout(() => {try {alert("; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4443; classtype:attempted-user; sid:51416; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit out-of-bounds write attempt"; flow:to_server,established; file_data; content:"try { (function () { let a = { get val() { [...{a = 1.45}] = []|3B| a.val.x|3B| }, }|3B| a.val|3B| })()|3B| } catch (e) { } </script>"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2505; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=1137; classtype:attempted-user; sid:51392; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari JSValues type confusion attempt"; flow:to_server,established; file_data; content:"{|0A|    Array.prototype.constructor = {|0A| [Symbol.specie"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-7064; reference:url,googleprojectzero.blogspot.com/2019/08/jsc-exploits.html; classtype:attempted-user; sid:51389; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit GetIndexedPropertyStorage memory corruption attempt"; flow:to_server,established; file_data; content:".repeat("; content:".repeat("; within:50; content:"for (let"; content:"new ArrayBuffer("; within:50; fast_pattern; content:"charAt|28|0|29|"; content:"charAt|28|0|29|"; within:50; content:"charAt|28|0|29|"; within:50; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4442; reference:url,bugs.webkit.org/show_bug.cgi?id=190625; classtype:attempted-user; sid:51385; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari DFG InstanceOf model memory corruption attempt"; flow:to_server,established; file_data; content:".prototype = new Proxy|28|"; content:"getPrototypeOf|28|"; within:100; content:"return"; within:100; content:".prototype"; within:25; content:"|20|instanceof|20|"; within:200; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,googleprojectzero.blogspot.com/2019/08/jsc-exploits.html; classtype:attempted-user; sid:51384; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple WebKit JSArray component out-of-bounds access"; flow:to_server,established; file_data; content:"|0A|const v3 = [1337,1337,1337,1337]|3B 0A|const v6 = [1337,1337]|3B 0A 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8518; reference:url,support.apple.com/en-us/HT209599; reference:url,support.apple.com/en-us/HT209600; classtype:attempted-user; sid:51382; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit updateDescendantDependentFlags use-after-free attempt"; flow:to_server,established; file_data; content:"|3B| -webkit-opacity|3A| 0.716727864979|3B| }|0A|#htmlvar00001, .class1"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4317; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:50294; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit updateMinimumColumnHeight use-after-free attempt"; flow:to_server,established; file_data; content:"class8|22| multiple=|22|multiple|22|>|0A|<table class=|22|class2|22| checked=|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4323; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:50192; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple WebKit updateReferencedText use-after-free attempt"; flow:to_server,established; file_data; content:"|29 20 7B 0A 20 20 73 76 67 76 61 72 30 30 30 32 30 2E 61 64 64 45 76 65 6E 74 4C 69 73 74 65 6E 65 72 28 22 44 4F 4D 4E 6F 64 65 49 6E 73 65 72 74 65 64 22 2C 20 65 76 65 6E 74 68|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4315; reference:url,support.apple.com/en-bw/HT209141; classtype:attempted-user; sid:50034; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit RegEx engine optimization arbitrary code execution attempt"; flow:to_server,established; file_data; content:"regexLastIndex.toString = function() {"; fast_pattern:only; content:"reg.lastIndex = regexLastIndex|3B|"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,bugs.webkit.org/show_bug.cgi?id=191731; classtype:attempted-user; sid:48547; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple WebKit memory corruption attempt"; flow:to_server,established; file_data; content:"trigger(|27|this.result = o[0]|27|, |27|o[0] = val|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4233; reference:url,support.apple.com/en-us/HT208848; classtype:attempted-user; sid:47023; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_server,established; file_data; content:".capitalize:first-letter {|0A|text-transform: uppercase"; fast_pattern; content:".block {|0A|display: block|3B 0A|}"; within:500; metadata:policy max-detect-ips drop, service smtp; reference:cve,2010-1392; classtype:attempted-user; sid:45734; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_server,established; file_data; content:".first:first-letter {|0A 20 20 20 20 20 20 20 20|font-size:"; fast_pattern; content:".second {|0A 20 20 20 20 20 20 20 20|display: block|3B 0A 20 20 20 20|}"; within:500; metadata:policy max-detect-ips drop, service smtp; reference:cve,2010-1392; classtype:attempted-user; sid:45732; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari FTP URL cross-domain restriction bypass attempt"; flow:to_server,established; file_data; content:"iframe"; nocase; content:"ftp|3A|//"; within:200; fast_pattern; nocase; content:"%40"; within:100; content:"%2F"; within:100; nocase; content:"%23@"; within:100; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,73977; reference:cve,2015-1126; classtype:misc-activity; sid:41855; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari URI spoofing attempt"; flow:to_client,established; file_data; content:"location"; nocase; content:"setInterval"; distance:0; nocase; pcre:"/(^|\s)location\s*=.*?setInterval\s*\([^,]+,\s*\d{1,2}[^\d]/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-1084; classtype:policy-violation; sid:35044; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit rowspan denial of service attempt"; flow:to_server,established; file_data; content:"<td"; nocase; content:"rowspan"; within:50; nocase; pcre:"/rowspan\s*=\s*[\x22\x27]?\s*\d{6}/si"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2007-0342; classtype:attempted-dos; sid:33911; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_server,established; file_data; content:"document.body.offsetTop"; nocase; content:"absolute"; within:125; nocase; content:"absolute"; within:125; nocase; content:"document.body.offsetTop"; within:200; nocase; pcre:"/var\s+(?P<element1>\w+)\s*?=\s*?document\.getElementById.*?var\s+(?P<element2>\w+)\s*?=\s*?(?P=element1).style.*?(?P=element2)\.height\s*?=\s*?[\x22\x27]\d/si"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29812; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_server,established; file_data; content:"float:"; content:"document.body.offsetTop"; nocase; content:"absolute"; content:"document.body.offsetTop"; nocase; pcre:"/body\.offsetTop\x3b.*?\.position\s*?=\s*?[\x22\x27]absolute[\x22\x27].*?\.offsetTop\x3b.*?\.height\s*=.*?\.display\s*=/si"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29811; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_client,established; file_data; content:"document.body.offsetTop"; nocase; content:"absolute"; within:125; nocase; content:"absolute"; within:125; nocase; content:"document.body.offsetTop"; within:200; nocase; pcre:"/var\s+(?P<element1>\w+)\s*?=\s*?document\.getElementById.*?var\s+(?P<element2>\w+)\s*?=\s*?(?P=element1).style.*?(?P=element2)\.height\s*?=\s*?[\x22\x27]\d/si"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29810; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple WebKit QuickTime plugin content-type http header buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.quicktime|file.smil; content:"Content-Type: "; http_header; content:!"|3B|"; within:255; http_header; content:!"|0A|"; within:255; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2012-3753; reference:url,attack.mitre.org/techniques/T1176; classtype:attempted-user; sid:29394; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit libxslt arbitrary file creation attempt"; flow:to_server,established; file_data; content:"http://icl.com/saxon"; fast_pattern:only; content:":output"; nocase; pcre:"/\s*[^>]file=/iR"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,48840; reference:cve,2011-1774; reference:url,attack.mitre.org/techniques/T1220; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:26592; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari SVG Markers Memory Use-After-Free attempt"; flow:to_client,established; flowbits:isset,file.svg; file_data; content:"marker id"; fast_pattern; nocase; content:"removeChild"; distance:0; nocase; content:"document.getElementById"; within:35; nocase; pcre:"/marker id\s*\x3d\s*["']?(?P<m1>\w+)["'\s].*?marker\x2d(start|mid|end).*?removeChild\s*\x28\s*document\x2egetElementById\x28\s*["']?(?P=m1)["'\s]/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46677; reference:cve,2011-1453; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:26258; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_server,established; file_data; content:"<style"; content:"title"; within:200; content:"</style>"; within:200; content:"<script"; within:200; content:"innerHTML"; within:200; content:"title"; within:200; content:"</script"; within:200; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:25040; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_server,established; file_data; content:"<style>*"; nocase; content:"</style>"; distance:0; content:"<script"; distance:0; nocase; content:"<title"; distance:0; nocase; content:"</script"; distance:0; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:25039; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit form elements virtual function DoS attempt"; flow:established,to_client; file_data; content:" form="; fast_pattern; content:"<form"; nocase; content:"</form>"; distance:0; nocase; content:" form="; distance:0; nocase; pcre:"/<form\s[^>]*?id=[^>]+?>[^<]*?<\/form>.*?<\w+(?<!form)\s[^>]*?form=/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2011-2813; reference:url,support.apple.com/kb/HT4981; classtype:attempted-dos; sid:25036; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari innerHTML use after free exploit attempt"; flow:to_client,established; file_data; content:"setTimeout"; nocase; content:"document.body.innerHTML"; distance:0; nocase; content:"document.getElementById("; distance:0; nocase; content:".innerHTML"; distance:0; nocase; pcre:"/setTimeout.*?\x7b[^\x7d]*document\.body\.innerHTML.*?\x7d.*document\.getElementById\x28(?P<q1>\x22|\x27|)(?P<m1>\w+?)(?P=q1)\x29\.innerHTML.*?div\s+id\s*\x3d\s*(?P<q2>\x22|\x27|)(?P=m1)(?P=q2)/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,48844; reference:cve,2011-0221; classtype:attempted-user; sid:21189; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit Display box rendering corruption attempt"; flow:to_client,established; file_data; content:"-webkit-box"; fast_pattern:only; content:"<script"; nocase; content:"function "; distance:0; nocase; content:".getElementById("; distance:0; nocase; content:".removeChild("; distance:0; nocase; content:".appendChild("; distance:0; nocase; pcre:"/\x2egetelementbyid\x28(?P<m1>\x22|\x27|)(?P<q1>\w+?)(?P=m1).*?\x2eremoveChild\x28(?P<m2>\x22|\x27|)(?P=q1)(?P=m2).*?\x2eappendChild\x28(?P<m3>\x22|\x27|)(?P=q1)(?P=m3)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48960; reference:cve,2011-2818; classtype:attempted-user; sid:20997; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit SVG memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.svg; content:"|2E|svg"; nocase; content:"documentElement"; distance:0; nocase; pcre:"/\x3cscript.*documentElement\x2e(height|preserveAspectRatio|viewBox|width|x|y)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48844; reference:cve,2011-0222; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:19807; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_client,established; file_data; content:"<style>"; nocase; content:"|3A|first-letter"; distance:0; nocase; content:"display|3A 20|block"; distance:0; nocase; pcre:"/(?P<a>\w+)\s*\x7b[^\x7d]*?display\s*\x3a\s*block.*?\x3cinput(?=[^\x3e]+type\s*\x3d\s*[\x22\x27]?(button|submit))[^\x3e]+class\s*\x3d\s*[\x22\x27]?(?P=a)/si"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,40644; reference:cve,2010-1392; classtype:attempted-user; sid:18973; rev:9;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit attribute child removal code execution attempt"; flow:to_server,established; file_data; content:"document.getElementById"; nocase; content:".getAttributeNode"; within:80; nocase; content:".childNodes"; within:60; nocase; content:"setTimeout"; content:"nodes|5B 30 5D|.textContent"; within:150; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,40642; reference:cve,2010-1119; classtype:attempted-user; sid:18958; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari information disclosure and remote code execution attempt"; flow:to_client,established; file_data; content:"parent"; content:".prompt"; distance:0; pcre:"/var\s+(\w+)\s*\x3D\s*parent\s*\x3b.*\1\x2Eprompt.*\1\x2Eclose/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2010-1939; reference:url,secunia.com/advisories/39670; classtype:attempted-user; sid:16596; rev:13;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari x-unix-mode executable mail attachment"; flow:to_server,established; content:"x-unix-mode"; fast_pattern:only; pcre:"/x-unix-mode\s*\x3D\s*(?(?=\d{4})[0-7]([1357][0-7]{2}|[0-7][1357][0-7]|[0-7]{2}[1357])|([1357][0-7]{2}|[0-7][1357][0-7]|[0-7]{2}[1357]))/smi"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,16736; reference:cve,2006-0848; reference:url,www.heise.de/english/newsticker/news/69919; reference:url,www.kb.cert.org/vuls/id/999708; classtype:attempted-user; sid:5714; rev:13;)
